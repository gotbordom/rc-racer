version: '3.8'

services:
  rc-racer:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    container_name: rc-racer
    runtime: nvidia
    network_mode: host
    privileged: true
    volumes:
      - ../src:/workspace/src
      - ../launch:/workspace/launch
      - /dev:/dev
    environment:
      - DISPLAY=${DISPLAY}
      - ROS_DOMAIN_ID=0
    devices:
      - /dev/video0:/dev/video0  # Camera
      - /dev/video1:/dev/video1  # Camera (if second camera)
      - /dev/ttyUSB0:/dev/ttyUSB0  # GPS/Serial devices
      - /dev/i2c-1:/dev/i2c-1  # IMU
    command: /bin/bash

